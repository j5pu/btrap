# shellcheck shell=sh

#
# Rebash library.

####################################### rebash
# Rebash
# Globals
#   OPTION        Option to profile.
#   PATH          PATH.
#   PROFILE       Path to profile.
# Optional Arguments:
#   caller        if caller is file, parent caller will be prefixed to 'PROFILE'.
#   force         Force regenerate files for 'PROFILE'.
#   version       Version.
#######################################
# shellcheck disable=SC2240
rebash() {
  executable="${1:-}"
  PROFILE='/etc/profile'

  if [ -x "${executable:-}" ] && bin="${executable%/*}" && [ "${bin}" != "/usr/local/bin" ]; then
    root="${bin%/*}"
    PATH="${root}/sbin:${bin}:${PATH}"; unset bin
    PROFILE="${root:-}${PROFILE}"; unset root
    if [ -r "${PROFILE}" ]; then
      shift
    else
      echo rebash.lib: "${PROFILE}": No such file
      return 1 2>/dev/null || exit 1
    fi
  fi
  unset executable

  . "${PROFILE}"

  for arg do
    case "${arg}" in
      -h|--help) usage "${0}" ;;
      --desc) desc "${0}" ;;
      --version) rc.d.version ;;
    esac
  done
  unset arg
}

# shellcheck disable=SC3045
[ ! "${BASH_VERSION-}" ] || export -f rebash
