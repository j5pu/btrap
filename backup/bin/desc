#!/bin/sh

# Show description for script (absolute path) or executable (in PATH).
#
set -eu; PATH="$(dirname "${0}"):${PATH}" && . strict.lib && . die.lib

main() {
  script="${1}"
  echo "${1}" | grep -qE '^/' || { script="$(which "${script}")" || { die Not Found: "${1}"; exit $?; }; }
  _desc="$(awk '/^#/ && ! /^#!/ && ! /^##/ && ! /^#$/ && ! /^# shellcheck/ {sub(/^# /, ""); print $0=$0 }' \
    "${script}" | head -1)"
  [ "${_desc-}" ] || { die Not Description: "${script}"; exit $?; }
  echo "${_desc}"
  exit
}

for arg do
  case "${arg}" in
    -h|--help) usage "${0}" ;;
    --desc) main "${0}" ;;
    --version) rc.d.version ;;
  esac
done

main "${1:-}"
