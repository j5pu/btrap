#!/bin/sh

####################################### âœ“ real: exported function
# Absolute logical (symlink) or resolved (physical) path (if does not exists, accepts one level up to cd).
# Arguments:
#   --usage             Show help message and exit.
#   path                  Path (default: cwd).
# Output:
#   Path or help message to stdout.
# Returns:
#   1 if parent directory does not exists or --usage and not man page.
#######################################
usage "${@}" || exit
logical=false

for arg do
  case "${arg}" in
    -l|--logical) logical=true ;;
    *) relative="${arg}"
  esac
done

relative="${relative-.}"
[ -d "${relative}" ] || basename="/$(basename "${relative}")"  # does not exists or is file
cd "$(dirname "${relative}")" || exit 1

if $logical; then
  echo "$(pwd)${basename}"
else
  echo "$(pwd -P)${basename}"
fi
unset arg basename logical relative

