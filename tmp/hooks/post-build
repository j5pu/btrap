#!/bin/bash
set -e

#######################################
# Docker hub post-build hook
# https://docs.docker.com/docker-hub/builds/advanced/
# https://dev.to/samuelea/automate-your-builds-on-docker-hub-by-writing-a-build-hook-script-13fp
# https://codeclimbing.com/automate-your-builds-on-docker-hub-by-writing-a-build-hook-script/
# SOURCE_BRANCH:      Name of the branch or the tag that is currently being tested.
# SOURCE_COMMIT:      SHA1 hash of the commit being tested.
# COMMIT_MSG:         Message from the commit being tested and built.
# DOCKER_REPO:        Name of the Docker repository being built.
# DOCKERFILE_PATH:    Dockerfile currently being built.
# DOCKER_TAG:         Docker repository tag being built.
# IMAGE_NAME:         Name and tag of the Docker repository being built.
#                     (This variable is a combination of DOCKER_REPO:DOCKER_TAG.)
#######################################
main() {
  local image tag
  while read -r image tag; do
    docker push "${tag}"
  done <<< "${input}"
}
####################################### Autogenerated by: images.sh
input=$(cat <<eot
alpine:latest j5pu/rc:alpine
eot
)

main
